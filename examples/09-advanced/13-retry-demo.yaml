testcase: "TC-13-RETRY-DEMO"
description: "Simple demonstration of retry functionality"

variables:
  vars:
    base_url: "https://httpbin.org"
    expected_status: "500"

steps:
  # Test 1: Simple retry - will retry 3 times then succeed
  - name: "Test HTTP request with retry (will fail but continue)"
    action: http
    args: ["GET", "${base_url}/status/500"]
    retry:
      attempts: 3
      delay: "1s"
      backoff: "fixed"
    result: retry_result

  # Test 2: Show that we can continue after failures
  - name: "Test successful request (no retry needed)"
    action: http
    args: ["GET", "${base_url}/status/200"]
    retry:
      attempts: 3
      delay: "500ms"
      stop_on_success: true
    result: success_result

  # Test 3: Verify the successful request worked
  - name: "Verify success result"
    action: assert
    args: ["${success_result.status_code}", "==", "200", "Should be 200"]

  # Test 4: Exponential backoff demonstration
  - name: "Test exponential backoff"
    action: log
    args: ["Testing exponential backoff - will wait 500ms, 1s, 2s between attempts"]

  - name: "HTTP with exponential backoff"
    action: http
    args: ["GET", "${base_url}/status/503"]
    retry:
      attempts: 4
      delay: "500ms"
      backoff: "exponential"
    result: exponential_result

  # Test 5: Final summary
  - name: "Log test completion"
    action: log
    args: ["Retry demonstration completed successfully"]