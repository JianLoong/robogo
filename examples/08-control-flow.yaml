testcase: "TC-CONTROL-FLOW-PROPERTIES"
description: "Test control flow as step properties: if, for, while"

variables:
  vars:
    test_value: "5"
    threshold: "3"
    should_run: "true"

steps:
  # Test if property with true condition
  - name: "Conditional step that runs"
    if: "true"
    action: log
    args: ["This step runs because condition is true"]

  # Test if property with false condition
  - name: "Conditional step that skips"
    if: "false"
    action: log
    args: ["This step should be skipped"]

  # Test if property with variable comparison
  - name: "Variable comparison step"
    if: "${test_value} > ${threshold}"
    action: log
    args: ["Value ${test_value} is greater than ${threshold}"]

  # Test if property with variable comparison that fails
  - name: "Skip this step"
    if: "${test_value} < ${threshold}"
    action: log
    args: ["This should not run"]

  # Test for property with range
  - name: "Log iteration number"
    for: "1..3"
    action: log
    args: ["For range iteration: ${iteration}, item: ${item}"]

  # Test for property with array
  - name: "Log fruit name"
    for: "[apple,banana,cherry]"
    action: log
    args: ["Processing fruit: ${item} at index ${index}"]

  # Test for property with count
  - name: "Count-based iteration"
    for: "2"
    action: log
    args: ["Count iteration ${iteration}: ${item}"]

  # Test while property
  - name: "While loop iteration"
    while: "${iteration} <= 3"
    action: log
    args: ["While iteration: ${iteration}"]

  # Test nested: for with if
  - name: "Conditional in loop"
    for: "1..4"
    if: "${iteration} == 2"
    action: log
    args: ["Even iteration: ${iteration}"]

  # Test variable setting in loop
  - name: "Set loop variable"
    for: "[x,y,z]"
    action: variable
    args: ["loop_item", "${item}"]

  # Test assert in loop
  - name: "Assert iteration is positive"
    for: "1..2"
    action: assert
    args: ["${iteration}", ">", "0"]

  # Final test
  - name: "Final success message"
    action: log
    args: ["All control flow property tests completed!"]