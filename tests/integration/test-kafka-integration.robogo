testcase: "Kafka Integration Test"
description: "Integration test for Kafka using RoboGo. Publishes and consumes a message."

variables:
  vars:
    kafka_broker: "localhost:9092"
    kafka_topic: "robogo_test"
    test_message: "hello from robogo"

steps:
  - name: "Publish message"
    action: kafka
    args: ["publish", "${kafka_broker}", "${kafka_topic}", "${test_message}"]
    description: "Publish a test message to Kafka"

  - name: "Log after publish"
    action: log
    args: ["Published message to Kafka successfully"]

  - name: "Consume message"
    action: kafka
    args:
      - "consume"
      - "${kafka_broker}"
      - "${kafka_topic}"
      - 
        fromOffset: "first"
        count: 100
        timeout: 5
    result: consumed
    description: "Consume a message from Kafka"

  - name: "Log consumed result"
    action: log
    args: ["Consumed result: ${consumed}"]

  - name: "Assert message"
    action: assert
    args:
      - "${consumed}"
      - "contains"
      - "hello from robogo"
    description: "Assert the consumed result contains the expected message" 